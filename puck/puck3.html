<html>
 <head>
    <!-- see https://tonejs.github.io -->
    <script src="https://unpkg.com/@webcomponents/webcomponentsjs@^2/webcomponents-bundle.js"></script>
    <script src="https://unpkg.com/tone"></script>
    <script src="https://unpkg.com/@tonejs/ui"></script>
    <script src="https://www.puck-js.com/puck.js"></script>

    <script>
        const synth = new Tone.AMSynth().toMaster();
        var button = false;
        var b0, b1;

        function getButtonValue() {
            Puck.eval("BTN.read()", function(v) { button = v; });
            return button;
        }
        function start() {
        Puck.write('LED1.reset();\n');
        setInterval(function loop() {
            b0 = button;
            b1 = getButtonValue();
            if (!b0 && b1) {
                console.log('attack');
                synth.triggerAttack('C4');
            }
            else if (b0 && !b1) {
                console.log('release');
                synth.triggerRelease();
            }
        }, 500);
    }
    </script>
 </head>
 <body>
    <button onclick="start()">Connect to BLE device.</button>
</body>
</html>
